<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PGP Encryption Tool</title>
    <link rel="stylesheet" href="https://unpkg.com/mdui@1.0.2/dist/css/mdui.min.css">
    <script src="https://unpkg.com/mdui@1.0.2/dist/js/mdui.min.js"></script>

    <style>
        body {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
            background-color: var(--mdui-color-background);
            color: var(--mdui-color-text);
        }
        
        textarea, #dropArea {
            width: 100%;
            box-sizing: border-box;
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            background-color: var(--mdui-color-surface);
            color: var(--mdui-color-text);
            transition: all 0.3s;
        }
        
        textarea {
            resize: vertical; 
            min-height: 100px;
            border: 1px solid rgba(0,0,0,0.12);
        }
        
        #dropArea {
            border: 2px dashed rgba(0,0,0,0.12);
            border-radius: 5px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        #dropArea.highlight {
            border-color: var(--mdui-color-primary); 
            background-color: var(--mdui-color-primary-container);
            color: var(--mdui-color-on-primary-container);
        }
        
        .section {
            margin: 20px 0; 
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0,0,0,0.08);
        }
        
        #loading {
            display: none; 
            text-align: center; 
            margin: 10px 0;
        }
        
        #progress {
            width: 100%;
            height: 4px;
            background-color: var(--mdui-color-surface-variant);
            margin-top: 10px;
            display: none;
            overflow: hidden;
            position: relative;
        }
        
        #progress-bar {
            height: 100%;
            background-color: var(--mdui-color-primary);
            width: 0%;
            transition: width 0.3s;
        }
        
        .hidden {
            display: none !important;
        }
         
        .error-message {
            color: red;
            display: none;
        }

        
        #result {
            margin-top: 10px;
            border: 1px solid rgba(0,0,0,0.12);
            padding: 10px;
            background-color: var(--mdui-color-surface);
            color: var(--mdui-color-text);
            display: none;
            word-break: break-all;
            white-space: pre-wrap;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .mode-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .input-container {
            position: relative;
        }
        
        @media (max-width: 768px) {
            body { 
                padding: 10px; 
            }
            
            .mdui-btn-group .mdui-btn {
                margin: 5px 0;
            }
        }

        @media (prefers-color-scheme: dark) {
            body {
                background-color: var(--mdui-color-surface);
                color: var(--mdui-color-on-surface);
            }
            
            textarea, #dropArea {
                background-color: var(--mdui-color-surface-container);
                color: var (--mdui-color-on-surface);
                border-color: rgba(255,255,255,0.12);
            }
            
            #result {
                background-color: var(--mdui-color-surface-container);
                color: var (--mdui-color-on-surface);
                border-color: rgba(255,255,255,0.12);
            }
            
            #dropArea.highlight {
                border-color: var(--mdui-color-primary);
                background-color: var(--mdui-color-primary-container);
                color: var(--mdui-color-on-primary-container);
            }
        }
        
        /* 明确定义深色主题样式类，用于手动切换 */
        .dark-theme {
            background-color: var(--mdui-color-surface);
            color: var(--mdui-color-on-surface);
        }
        
        .dark-theme textarea, 
        .dark-theme #dropArea {
            background-color: var(--mdui-color-surface-container);
            color: var (--mdui-color-on-surface);
            border-color: rgba(255,255,255,0.12);
        }
        
        .dark-theme #result {
            background-color: var (--mdui-color-surface-container);
            color: var (--mdui-color-on-surface);
            border-color: rgba(255,255,255,0.12);
        }
        
        /* 为iframe模式添加特殊样式 */
        .in-iframe {
            max-width: 100%;
            margin: 0;
            padding: 10px;
        }
    </style>
</head>
<body class="mdui-theme-primary-indigo mdui-theme-accent-blue">
    <div class="section mdui-typo" id="footerSection">
        <h2 class="mdui-typo-headline" style="text-align: center;">PGP Encryption Tool</h2>
        <p>We use <a href="https://github.com/stevezmtstudios.gpg" target="_blank" class="mdui-text-color-primary">Steve ZMT's Public key</a> to encrypt your data safely in your browser</p>
        <p>All data would not save or send to anyone.</p>
        <hr />
        <p>In any case, if you would like better support, to use GPG with other applications, or to handle your keys in a more secure way, please <a href="./index.html?auto=false" target="_blank">Get GnuPG</a> on your device.
    </div>
    <div class="section" id="inputSection">
        <div class="mode-buttons mdui-btn-group">
            <button id="textModeBtn" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-blue-a400"><i class="mdui-icon material-icons">&#xe0d8;</i> Text</button>
            <button id="fileModeBtn" class="mdui-btn mdui-color-white mdui-shadow-1 mdui-ripple"><i class="mdui-icon material-icons">&#xe24d;</i> File</button>
        </div>
        
        <div class="input-container mdui-textfield mdui-textfield-floating-label">
            
            <textarea id="plaintext" class="mdui-textfield-input mdui-ripple mdui-shadow-1 mdui-color-grey-200" placeholder="Type or paste your message here" rows="2"></textarea>
            
            <div id="dropArea" class="hidden mdui-shadow-1 mdui-color-white">
                Drag file here or click here to upload.
                <input type="file" id="fileInput" style="display:none;" />
            </div>
            <div id="fileInfo" class="mdui-typo-caption-opacity"></div>
        </div>
        <p id="errorMessage" class="error-message">Youza, the file or messages are too big. Use <a href="./index.html" target="_blank">local encryption tool</a> instead.</p>
        
        <!-- 高级选项折叠栏 -->
        <div class="mdui-panel" mdui-panel>
            <div class="mdui-panel-item">
                <div class="mdui-panel-item-header mdui-clearfix">
                    <i class="mdui-icon material-icons">&#xe8b8;</i>
                    <div class="mdui-panel-item-title">Advanced Options</div>
                    <i class="mdui-icon material-icons mdui-panel-item-arrow">&#xe313;</i>
                </div>
                
                <div class="mdui-panel-item-body">
                    <!-- 自定义公钥部分 -->
                    <div class="mdui-typo-title">
                        <i class="mdui-icon material-icons">&#xe0da;</i> Recipient's Public Key
                    </div>
                    <div class="mdui-row">
                        <div class="mdui-col-xs-12">
                            <label class="mdui-checkbox">
                                <input type="checkbox" id="useCustomPublicKey"/>
                                <i class="mdui-checkbox-icon"></i>
                                Use custom public key instead of default
                            </label>
                        </div>
                    </div>
                    
                    <div id="customPublicKeyOptions" style="display:none; margin-top:10px;">
                        <div class="mdui-tab" id="publicKeyTab" mdui-tab>
                            <a href="#pubkey-text" class="mdui-ripple">
                                <i class="mdui-icon material-icons">&#xe14d;&#xe3c9;</i>
                            </a>
                            <a href="#pubkey-file" class="mdui-ripple">
                                <i class="mdui-icon material-icons">&#xe24d;&#xe2c6;</i>
                            </a>
                        </div>
                        <div id="pubkey-text" class="mdui-p-a-2">
                            <div class="mdui-textfield">
                                <label class="mdui-textfield-label">Paste PGP public key here</label>
                                <textarea class="mdui-textfield-input" id="customPublicKeyText" rows="3" placeholder="-----BEGIN PGP PUBLIC KEY BLOCK-----"></textarea>
                                <div class="mdui-textfield-error" id="customPublicKeyTextError"></div>
                                <div class="mdui-textfield-helper" id="customPublicKeyTextHelper"></div>
                            </div>
                            <button id="pastePublicKey" class="mdui-btn mdui-ripple mdui-color-theme-accent">
                                <i class="mdui-icon material-icons" id="pastePublicKeyIcon">&#xe14f;</i> 
                                <span id="pastePublicKeyText">Paste from Clipboard</span>
                            </button>
                        </div>
                        <div id="pubkey-file" class="mdui-p-a-2">
                            <div class="mdui-textfield">
                                <input type="file" id="customPublicKeyFile" class="mdui-btn"/>
                                <div class="mdui-textfield-error" id="publicKeyFileError"></div>
                                <div class="mdui-textfield-helper" id="publicKeyFileInfo"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mdui-divider" style="margin: 16px 0;"></div>
                    
                    <!-- 签名部分 -->
                    <div class="mdui-typo-title">
                        <i class="mdui-icon material-icons">&#xe155;</i> Sign Message
                    </div>
                    <div class="mdui-row">
                        <div class="mdui-col-xs-12">
                            <label class="mdui-checkbox">
                                <input type="checkbox" id="signMessage"/>
                                <i class="mdui-checkbox-icon"></i>
                                Sign message with your private key
                            </label>
                        </div>
                    </div>
                    
                    <div id="signOptions" style="display:none; margin-top:10px;">
                        <div class="mdui-tab" id="privateKeyTab" mdui-tab>
                            <a href="#privkey-text" class="mdui-ripple">
                                <i class="mdui-icon material-icons">&#xe14d;&#xe3c9;</i>
                            </a>
                            <a href="#privkey-file" class="mdui-ripple">
                                <i class="mdui-icon material-icons">&#xe24d;&#xe2c6;</i>
                            </a>
                        </div>
                        <div id="privkey-text" class="mdui-p-a-2">
                            <div class="mdui-textfield">
                                <label class="mdui-textfield-label">Paste PGP private key here, your key won't save</label>
                                <textarea class="mdui-textfield-input" id="privateKeyText" rows="3" placeholder="-----BEGIN PGP PRIVATE KEY BLOCK-----"></textarea>
                                <div class="mdui-textfield-error" id="privateKeyTextError"></div>
                                <div class="mdui-textfield-helper" id="privateKeyTextHelper"></div>
                            </div>
                            <button id="pastePrivateKey" class="mdui-btn mdui-ripple mdui-color-theme-accent">
                                <i class="mdui-icon material-icons" id="pastePrivateKeyIcon">&#xe14f;</i> 
                                <span id="pastePrivateKeyText">Paste from Clipboard</span>
                            </button>
                        </div>
                        <div id="privkey-file" class="mdui-p-a-2">
                            <div class="mdui-textfield">
                                <input type="file" id="privateKeyFile" class="mdui-btn">
                                <div class="mdui-textfield-error" id="privateKeyFileError"></div>
                                <div class="mdui-textfield-helper" id="privateKeyFileInfo"></div>
                            </div>
                        </div>
                        
                        <div class="mdui-textfield mdui-textfield-floating-label">
                            <i class="mdui-icon material-icons">&#xe897;</i>
                            <label class="mdui-textfield-label"> 
                                Private key passphrase (if encrypted)
                            </label>
                            <input class="mdui-textfield-input" type="password" id="privateKeyPassphrase"/>
                            <div class="mdui-textfield-error" id="privateKeyPassphraseError"></div>
                            <div class="mdui-textfield-helper">Leave empty if your key is not password protected</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <div class="mdui-btn-group">
            <button id="encryptBtn" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons">&#xe897;</i> Encrypt
            </button>
            <button id="clearBtn" class="mdui-btn mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons">&#xe14c;</i> Clear
            </button>
        </div>
    </div>
    
    <div id="loading" class="mdui-progress">
        <div class="mdui-progress-indeterminate"></div>
        <div class="mdui-typo-caption-opacity" id="progressText"></div>
        <div id="progress"><div id="progress-bar"></div></div>
    </div>
    
    <div id="resultSection" class="section hidden">
        <p class="mdui-typo">Encrypt result</p>
        <div class="mdui-btn-group">
            <button id="copyResult" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons">&#xe14d;</i> Copy to Clipboard
            </button>
            <button id="downloadResult" class="mdui-btn mdui-btn-raised mdui-ripple hidden mdui-color-white">
                <i class="mdui-icon material-icons">&#xe2c4;</i> Download GPG
            </button>
            <button id="emailResult" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons">&#xe0e1;</i> Send Email
            </button>
        </div>
        <div id="result" class="mdui-shadow-1 mdui-color-white"></div>
    </div>

    
    <script src="https://unpkg.com/mdui@1.0.2/dist/js/mdui.min.js"></script>
    
    <!-- OpenPGP.js  -->
    <!--[if lte IE 9]>
    <script src="https://gcore.jsdelivr.net/npm/es5-shim@4.5.10/es5-shim.min.js"></script>
    <script src="https://gcore.jsdelivr.net/npm/es5-shim@4.5.10/es5-sham.min.js"></script>
    <![endif]-->
    <script src="https://gcore.jsdelivr.net/npm/openpgp@5.0.0/dist/openpgp.min.js"></script>
    
    <script>
    (function() {
        if (!window.console) window.console = { log: function() {} };
        if (!window.Promise) {
            document.write('<script src="https://gcore.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"><\/script>');
        }
        
        var publicKey = `-----BEGIN PGP PUBLIC KEY BLOCK-----

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
=clHT
-----END PGP PUBLIC KEY BLOCK-----
`;
        
        var selectedFile = null;
        var encryptedData = null;
        var currentMode = 'text';
        var inIframe = window.self !== window.top; // 检测是否在iframe中
        var customPublicKeyObj = null; // 自定义公钥对象
        var privateKeyObj = null; // 私钥对象
        
        var plaintext = document.getElementById('plaintext');
        var textModeBtn = document.getElementById('textModeBtn');
        var fileModeBtn = document.getElementById('fileModeBtn');
        var encryptBtn = document.getElementById('encryptBtn');
        var clearBtn = document.getElementById('clearBtn');
        var dropArea = document.getElementById('dropArea');
        var fileInput = document.getElementById('fileInput');
        var fileInfo = document.getElementById('fileInfo');
        var loading = document.getElementById('loading');
        var progress = document.getElementById('progress');
        var progressBar = document.getElementById('progress-bar');
        var progressText = document.getElementById('progressText');
        var resultSection = document.getElementById('resultSection');
        var result = document.getElementById('result');
        var copyResultBtn = document.getElementById('copyResult');
        var downloadResultBtn = document.getElementById('downloadResult');
        var footerSection = document.getElementById('footerSection');
        
        // 高级选项相关元素
        var useCustomPublicKey = document.getElementById('useCustomPublicKey');
        var customPublicKeyOptions = document.getElementById('customPublicKeyOptions');
        var customPublicKeyText = document.getElementById('customPublicKeyText');
        var customPublicKeyTextError = document.getElementById('customPublicKeyTextError');
        var customPublicKeyTextHelper = document.getElementById('customPublicKeyTextHelper');
        var customPublicKeyFile = document.getElementById('customPublicKeyFile');
        var publicKeyFileInfo = document.getElementById('publicKeyFileInfo');
        var publicKeyFileError = document.getElementById('publicKeyFileError');
        var pastePublicKey = document.getElementById('pastePublicKey');
        var pastePublicKeyIcon = document.getElementById('pastePublicKeyIcon');
        var pastePublicKeyText = document.getElementById('pastePublicKeyText');
        
        var signMessage = document.getElementById('signMessage');
        var signOptions = document.getElementById('signOptions');
        var privateKeyText = document.getElementById('privateKeyText');
        var privateKeyTextError = document.getElementById('privateKeyTextError');
        var privateKeyTextHelper = document.getElementById('privateKeyTextHelper');
        var privateKeyFile = document.getElementById('privateKeyFile');
        var privateKeyFileInfo = document.getElementById('privateKeyFileInfo');
        var privateKeyFileError = document.getElementById('privateKeyFileError');
        var privateKeyPassphrase = document.getElementById('privateKeyPassphrase');
        var privateKeyPassphraseError = document.getElementById('privateKeyPassphraseError');
        var pastePrivateKey = document.getElementById('pastePrivateKey');
        var pastePrivateKeyIcon = document.getElementById('pastePrivateKeyIcon');
        var pastePrivateKeyText = document.getElementById('pastePrivateKeyText');
        
        // 检测是否在iframe中并设置相应样式
        function setupIframeMode() {
            if (inIframe) {
                document.body.classList.add('in-iframe');
                footerSection.style.display = 'none'; // 在iframe中不显示页脚
                
                // 检测父页面是否为深色模式
                try {
                    // 向父页面发送消息获取当前主题
                    window.parent.postMessage({ type: 'requestTheme' }, '*');
                } catch (e) {
                    console.log('无法与父页面通信:', e);
                }
                
                // 监听来自父页面的消息
                window.addEventListener('message', function(event) {
                    if (event.data && event.data.type === 'themeInfo') {
                        if (event.data.isDarkMode) {
                            document.body.classList.add('dark-theme');
                        } else {
                            document.body.classList.remove('dark-theme');
                        }
                    }
                });
            }
        }
        
        // 向父页面发送高度信息
        function updateParentIframeHeight() {
            if (inIframe) {
                const height = document.body.scrollHeight;
                try {
                    window.parent.postMessage({ 
                        type: 'resize', 
                        height: height 
                    }, '*');
                } catch (e) {
                    console.error('无法向父页面发送消息:', e);
                }
            }
        }

        function initialize() {
            console.log("Using hardcoded public key");
            setupIframeMode();
            addEventListeners();
            // 初始化MDUI组件
            mdui.mutation();
            
            // 初始调整一次高度
            setTimeout(updateParentIframeHeight, 100);
        }
        
        function addEventListeners() {
            textModeBtn.addEventListener('click', function() {
                switchMode('text');
                setTimeout(updateParentIframeHeight, 100);
            });
            
            fileModeBtn.addEventListener('click', function() {
                switchMode('file');
                setTimeout(updateParentIframeHeight, 100);
            });
            
            encryptBtn.addEventListener('click', function() {
                if (currentMode === 'text') {
                    encryptTextHandler();
                } else {
                    encryptFileHandler();
                }
            });
            
            clearBtn.addEventListener('click', function() {
                if (currentMode === 'text') {
                    plaintext.value = '';
                } else {
                    clearFileHandler();
                }
                hideResult();
                errorMessage.style.display = 'none';
                encryptBtn.removeAttribute('disabled');
                setTimeout(updateParentIframeHeight, 100);
            });
            
            dropArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.className = 'highlight';
            });
            
            dropArea.addEventListener('dragleave', function() {
                this.className = '';
            });
            
            dropArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.className = '';
                handleFiles(e.dataTransfer.files);
            });
            
            dropArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', function() {
                handleFiles(this.files);
            });
            
            copyResultBtn.addEventListener('click', copyToClipboard);
            downloadResultBtn.addEventListener('click', downloadEncrypted);
            document.getElementById('emailResult').addEventListener('click', showEmailConfirmDialog);
            
            // 监听窗口大小变化
            window.addEventListener('resize', function() {
                setTimeout(updateParentIframeHeight, 100);
            });
            
            // 监听内容变化以更新iframe高度
            const observer = new MutationObserver(function(mutations) {
                setTimeout(updateParentIframeHeight, 100);
            });
            
            observer.observe(document.body, {
                childList: true,
                subtree: true,
                attributes: true
            });

            // 高级选项事件处理
            useCustomPublicKey.addEventListener('change', function() {
                customPublicKeyOptions.style.display = this.checked ? 'block' : 'none';
                customPublicKeyObj = null; // 重置公钥对象
                resetPublicKeyFeedback();
                setTimeout(updateParentIframeHeight, 100);
            });
            
            signMessage.addEventListener('change', function() {
                signOptions.style.display = this.checked ? 'block' : 'none';
                privateKeyObj = null; // 重置私钥对象
                resetPrivateKeyFeedback();
                setTimeout(updateParentIframeHeight, 100);
            });
            
            // 处理自定义公钥文本变化
            customPublicKeyText.addEventListener('input', function() {
                customPublicKeyObj = null; // 重置公钥对象
                validatePublicKey();
            });
            
            // 处理自定义公钥文件上传
            customPublicKeyFile.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    publicKeyFileInfo.textContent = 'Selected key: ' + file.name;
                    publicKeyFileError.textContent = '';
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            // 设置文本区域的内容
                            customPublicKeyText.value = e.target.result;
                            // 验证公钥
                            validatePublicKey();
                            
                            // 修复: 正确切换到文本标签页
                            document.querySelector('#publicKeyTab a[href="#pubkey-text"]').click();
                            
                            // 确保高级选项面板打开
                            const advancedPanel = document.querySelector('.mdui-panel-item');
                            if (!advancedPanel.classList.contains('mdui-panel-item-open')) {
                                advancedPanel.classList.add('mdui-panel-item-open');
                            }
                        } catch(err) {
                            console.error('Error reading public key file:', err);
                            publicKeyFileInfo.textContent = '';
                            publicKeyFileError.textContent = 'Error: ' + err.message;
                        }
                    };
                    reader.onerror = function() {
                        console.error('Error reading public key file');
                        publicKeyFileInfo.textContent = '';
                        publicKeyFileError.textContent = 'Cannot read file';
                    };
                    reader.readAsText(file);
                }
                setTimeout(updateParentIframeHeight, 100);
            });
            
            // 处理私钥文件上传
            privateKeyFile.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    privateKeyFileInfo.textContent = 'Selected key: ' + file.name;
                    privateKeyFileError.textContent = '';
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            // 设置文本区域的内容
                            privateKeyText.value = e.target.result;
                            // 验证私钥
                            validatePrivateKey();
                            
                            // 修复: 正确切换到文本标签页
                            document.querySelector('#privateKeyTab a[href="#privkey-text"]').click();
                            
                            // 确保高级选项面板打开
                            const advancedPanel = document.querySelector('.mdui-panel-item');
                            if (!advancedPanel.classList.contains('mdui-panel-item-open')) {
                                advancedPanel.classList.add('mdui-panel-item-open');
                            }
                        } catch(err) {
                            console.error('Error reading private key file:', err);
                            privateKeyFileInfo.textContent = '';
                            privateKeyFileError.textContent = 'Error: ' + err.message;
                        }
                    };
                    reader.onerror = function() {
                        console.error('Error reading private key file');
                        privateKeyFileInfo.textContent = '';
                        privateKeyFileError.textContent = 'Cannot read file';
                    };
                    reader.readAsText(file);
                }
                setTimeout(updateParentIframeHeight, 100);
            });
            
            // 添加粘贴公钥按钮功能
            pastePublicKey.addEventListener('click', function() {
                navigator.clipboard.readText()
                    .then(text => {
                        customPublicKeyText.value = text;
                        validatePublicKey();
                        
                        // 显示成功提示
                        updateButtonStatus(pastePublicKey, pastePublicKeyIcon, pastePublicKeyText, true, 'Pasted!');
                    })
                    .catch(err => {
                        console.error('Cannot access clipboard:', err);
                        
                        // 显示错误提示
                        updateButtonStatus(pastePublicKey, pastePublicKeyIcon, pastePublicKeyText, false, 'Cannot access clipboard');
                    });
            });
            
            // 添加粘贴私钥按钮功能
            pastePrivateKey.addEventListener('click', function() {
                navigator.clipboard.readText()
                    .then(text => {
                        privateKeyText.value = text;
                        validatePrivateKey();
                        
                        // 显示成功提示
                        updateButtonStatus(pastePrivateKey, pastePrivateKeyIcon, pastePrivateKeyText, true, 'Pasted!');
                    })
                    .catch(err => {
                        console.error('Cannot access clipboard:', err);
                        
                        // 显示错误提示
                        updateButtonStatus(pastePrivateKey, pastePrivateKeyIcon, pastePrivateKeyText, false, 'Cannot access clipboard');
                    });
            });
        }
        
        function switchMode(mode) {
            currentMode = mode;
            
            if (mode === 'text') {
                textModeBtn.classList.add('mdui-color-blue-a400');
                fileModeBtn.classList.remove('mdui-color-blue-a400');
                textModeBtn.classList.remove('mdui-color-white');
                fileModeBtn.classList.add('mdui-color-white');
                textModeBtn.classList.add('mdui-btn-raised');
                fileModeBtn.classList.remove('mdui-btn-raised');
                plaintext.classList.remove('hidden');
                dropArea.classList.add('hidden');
                
                fileInfo.textContent = '';
            } else {
                textModeBtn.classList.remove('mdui-color-blue-a400');
                fileModeBtn.classList.add('mdui-color-blue-a400');
                textModeBtn.classList.add('mdui-color-white');
                fileModeBtn.classList.remove('mdui-color-white');
                textModeBtn.classList.remove('mdui-btn-raised');
                fileModeBtn.classList.add('mdui-btn-raised');
                plaintext.classList.add('hidden');
                dropArea.classList.remove('hidden');
            }
            errorMessage.style.display = 'none'; // 隐藏错误信息
            encryptBtn.removeAttribute('disabled');
            hideResult();
        }
        
        function handleFiles(files) {
            if (!files.length) return;
            
            selectedFile = files[0];
            fileInfo.textContent = 'Selected file: ' + selectedFile.name + ' (' + formatFileSize(selectedFile.size) + ')';
            hideResult();
        }
        
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' bytes';
            else if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            else return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }
        
        function encryptTextHandler() {
            var text = plaintext.value.trim();
            if (!text) {
                mdui.snackbar({
                    message: 'Please enter text to encrypt.',
                    position: 'bottom',
                    timeout: 2000
                });
                return;
            }
            
            showLoading();
            progressText.textContent = '';
            
            setTimeout(function() {
                prepareKeysForEncryption()
                    .then(function(keysReady) {
                        if(keysReady) {
                            progressText.textContent = '';
                            return encryptText(text);
                        } else {
                            throw new Error('Key preparation failed');
                        }
                    })
                    .then(function(encrypted) {
                        encryptedData = encrypted;
                        showResult(encrypted, false);
                        hideLoading();
                    })
                    .catch(function(error) {
                        console.error('Encryption failed:', error);
                        hideLoading();
                        mdui.alert('Encryption failed: ' + error.message, 'Error');
                    });
            }, 100);
        }
        
        function encryptFileHandler() {
            if (!selectedFile) {
                mdui.snackbar({
                    message: 'Please select a file first.',
                    position: 'bottom',
                    timeout: 2000
                });
                return;
            }
            
            showLoading();
            showProgress();
            progressText.textContent = '';
            
            var reader = new FileReader();
            reader.onload = function(e) {
                var arrayBuffer = e.target.result;
                
                setTimeout(function() {
                    prepareKeysForEncryption()
                        .then(function(keysReady) {
                            if(keysReady) {
                                progressText.textContent = '';
                                return encryptBinaryData(arrayBuffer, selectedFile.name);
                            } else {
                                throw new Error('Key preparation failed');
                            }
                        })
                        .then(function(encrypted) {
                            encryptedData = encrypted.binary; 
                            showResult(encrypted.armored, true); 
                            hideLoading();
                            hideProgress();
                        })
                        .catch(function(error) {
                            console.error('File encryption failed:', error);
                            hideLoading();
                            hideProgress();
                            mdui.alert('File encryption failed: ' + error.message, 'Error');
                        });
                }, 100);
            };
            reader.onerror = function() {
                mdui.alert('Error reading file.', 'Error');
                hideLoading();
                hideProgress();
            };
            
            reader.readAsArrayBuffer(selectedFile);
        }
        
        function clearFileHandler() {
            selectedFile = null;
            fileInfo.textContent = '';
            fileInput.value = '';
            errorMessage.style.display = 'none'; // 隐藏错误信息
            encryptBtn.removeAttribute('disabled');
            hideResult();
        }
        
        function checkFileSize(size) {
            if (size > 4 * 1024 * 1024) { // 4MB in bytes
                errorMessage.style.display = 'block';
                encryptBtn.setAttribute('disabled', 'true');
            } else {
                errorMessage.style.display = 'none';
                encryptBtn.removeAttribute('disabled');
            }
        }

        fileInput.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                checkFileSize(file.size);
            }
        });

        plaintext.addEventListener('input', function(event) {
            const text = event.target.value;
            const byteLength = new Blob([text]).size;
            checkFileSize(byteLength);
        });
        
        async function validatePublicKey() {
            const keyText = customPublicKeyText.value.trim();
            if (!keyText) {
                customPublicKeyTextError.textContent = '';
                customPublicKeyTextHelper.textContent = '';
                return;
            }
            
            try {
                customPublicKeyTextHelper.textContent = 'Validating public key...';
                customPublicKeyTextError.textContent = '';
                
                const keyObj = await openpgp.readKey({ armoredKey: keyText });
                if (keyObj) {
                    customPublicKeyObj = keyObj;
                    customPublicKeyTextError.textContent = '';
                    customPublicKeyTextHelper.textContent = '✓ Valid public key';
                    customPublicKeyTextHelper.style.color = 'green';
                    
                    // 确保面板是开着的
                    const advancedPanel = document.querySelector('.mdui-panel-item');
                    if (!advancedPanel.classList.contains('mdui-panel-item-open')) {
                        advancedPanel.classList.add('mdui-panel-item-open');
                    }
                } else {
                    customPublicKeyTextHelper.textContent = '';
                    customPublicKeyTextError.textContent = '✗ Invalid public key format';
                }
            } catch (e) {
                console.error('Public key validation error:', e);
                customPublicKeyTextHelper.textContent = '';
                customPublicKeyTextError.textContent = '✗ Invalid public key: ' + e.message;
                customPublicKeyObj = null;
            }
            
            setTimeout(updateParentIframeHeight, 100);
        }
        
        async function validatePrivateKey() {
            const keyText = privateKeyText.value.trim();
            if (!keyText) {
                privateKeyTextError.textContent = '';
                privateKeyTextHelper.textContent = '';
                return;
            }
            
            try {
                privateKeyTextHelper.textContent = 'Validating private key...';
                privateKeyTextError.textContent = '';
                
                const keyObj = await openpgp.readPrivateKey({ armoredKey: keyText });
                if (keyObj) {
                    privateKeyTextHelper.textContent = '✓ Valid private key' + (keyObj.isDecrypted() ? '' : ' (requires passphrase)');
                    privateKeyTextHelper.style.color = 'green';
                    privateKeyTextError.textContent = '';
                    
                    // 确保面板是开着的
                    const advancedPanel = document.querySelector('.mdui-panel-item');
                    if (!advancedPanel.classList.contains('mdui-panel-item-open')) {
                        advancedPanel.classList.add('mdui-panel-item-open');
                    }
                } else {
                    privateKeyTextHelper.textContent = '';
                    privateKeyTextError.textContent = '✗ Invalid private key format';
                }
            } catch (e) {
                console.error('Private key validation error:', e);
                privateKeyTextHelper.textContent = '';
                privateKeyTextError.textContent = '✗ Invalid private key: ' + e.message;
                privateKeyObj = null;
            }
            
            setTimeout(updateParentIframeHeight, 100);
        }
        
        async function encryptText(text) {
            try {
                // 决定使用哪个公钥
                let encryptionKey;
                if (useCustomPublicKey.checked && customPublicKeyObj) {
                    encryptionKey = customPublicKeyObj;
                } else {
                    encryptionKey = await openpgp.readKey({ armoredKey: publicKey });
                }
                
                // 加密选项
                const encryptOptions = {
                    message: await openpgp.createMessage({ text: text }),
                    encryptionKeys: encryptionKey
                };
                
                // 如果需要签名并且有私钥，添加签名
                if (signMessage.checked && privateKeyObj) {
                    encryptOptions.signingKeys = privateKeyObj;
                }
                
                // 执行加密
                const encrypted = await openpgp.encrypt(encryptOptions);
                
                return encrypted;
            } catch (e) {
                console.error('Encryption error:', e);
                throw e;
            }
        }
        
        async function encryptBinaryData(data, filename) {
            try {
                // 决定使用哪个公钥
                let encryptionKey;
                if (useCustomPublicKey.checked && customPublicKeyObj) {
                    encryptionKey = customPublicKeyObj;
                } else {
                    encryptionKey = await openpgp.readKey({ armoredKey: publicKey });
                }
                
                // 创建二进制消息
                const binaryMessage = await openpgp.createMessage({ 
                    binary: new Uint8Array(data),
                    filename: filename 
                });
                
                // 二进制加密选项
                const binaryEncryptOptions = {
                    message: binaryMessage,
                    encryptionKeys: encryptionKey,
                    format: 'binary'
                };
                
                // 文本加密选项
                const armoredEncryptOptions = {
                    message: binaryMessage,
                    encryptionKeys: encryptionKey,
                    format: 'armored'
                };
                
                // 如果需要签名并且有私钥，添加签名
                if (signMessage.checked && privateKeyObj) {
                    binaryEncryptOptions.signingKeys = privateKeyObj;
                    armoredEncryptOptions.signingKeys = privateKeyObj;
                }
                
                // 执行加密
                const binaryEncrypted = await openpgp.encrypt(binaryEncryptOptions);
                const armoredEncrypted = await openpgp.encrypt(armoredEncryptOptions);
                
                return {
                    binary: binaryEncrypted,  
                    armored: armoredEncrypted 
                };
            } catch (e) {
                console.error('Binary encryption error:', e);
                throw e;
            }
        }
        
        function showResult(data, isFile) {
            resultSection.classList.remove('hidden');
            result.style.display = 'block';
            
            result.textContent = data;
            
            if (isFile) {
                downloadResultBtn.classList.remove('hidden');
                copyResultBtn.classList.add('hidden'); 
            } else {
                downloadResultBtn.classList.add('hidden');
                copyResultBtn.classList.remove('hidden'); 
            }
            
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            mdui.mutation();
            
            // 更新父页面的iframe高度
            setTimeout(updateParentIframeHeight, 100);
        }
        
        function hideResult() {
            resultSection.classList.add('hidden');
            result.style.display = 'none';
            encryptedData = null;
            
            // 更新父页面的iframe高度
            setTimeout(updateParentIframeHeight, 100);
        }
        
        function showLoading() {
            loading.style.display = 'block';
            updateParentIframeHeight();
        }
        
        function hideLoading() {
            loading.style.display = 'none';
            updateParentIframeHeight();
        }
        
        function showProgress() {
            progress.style.display = 'block';
            progressBar.style.width = '0%';
        }
        
        function hideProgress() {
            progress.style.display = 'none';
        }
        
        function copyToClipboard() {
            if (!result.textContent) return;
            
            var textArea = document.createElement('textarea');
            textArea.value = result.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                var successful = document.execCommand('copy');
                if (successful) {
                    // 保存原始内容
                    const originalHTML = copyResultBtn.innerHTML;
                    const originalClasses = copyResultBtn.className;
                    
                    // 更改按钮样式为成功状态
                    copyResultBtn.innerHTML = '<i class="mdui-icon material-icons">&#xe876;</i> Copied!';
                    copyResultBtn.className = originalClasses.replace('mdui-color-white', 'mdui-color-green');
                    
                    // 3秒后恢复
                    setTimeout(function() {
                        copyResultBtn.innerHTML = originalHTML;
                        copyResultBtn.className = originalClasses;
                    }, 3000);
                } else {
                    // 保存原始内容
                    const originalHTML = copyResultBtn.innerHTML;
                    const originalClasses = copyResultBtn.className;
                    
                    // 更改按钮样式为失败状态
                    copyResultBtn.innerHTML = '<i class="mdui-icon material-icons">&#xe002;</i> Failed to copy';
                    copyResultBtn.className = originalClasses.replace('mdui-color-white', 'mdui-color-red');
                    
                    // 3秒后恢复
                    setTimeout(function() {
                        copyResultBtn.innerHTML = originalHTML;
                        copyResultBtn.className = originalClasses;
                    }, 3000);
                }
            } catch (err) {
                // 保存原始内容
                const originalHTML = copyResultBtn.innerHTML;
                const originalClasses = copyResultBtn.className;
                
                // 更改按钮样式为失败状态
                copyResultBtn.innerHTML = '<i class="mdui-icon material-icons">&#xe002;</i> Failed to copy';
                copyResultBtn.className = originalClasses.replace('mdui-color-white', 'mdui-color-red');
                
                // 3秒后恢复
                setTimeout(function() {
                    copyResultBtn.innerHTML = originalHTML;
                    copyResultBtn.className = originalClasses;
                }, 3000);
                
                console.error('Error during copy:', err);
            }
            
            document.body.removeChild(textArea);
        }
        
        function downloadEncrypted() {
            if (!encryptedData || !(encryptedData instanceof Uint8Array)) {
                mdui.snackbar({
                    message: 'No encrypted file available.',
                    position: 'bottom',
                    timeout: 2000
                });
                return;
            }
            
            // 保存原始内容
            const originalHTML = downloadResultBtn.innerHTML;
            
            // 替换为加载图标
            downloadResultBtn.innerHTML = '<div class="mdui-valign"><i class="mdui-spinner"></i></div>';
            mdui.mutation(); // 初始化spinner组件
            
            try {
                var blob = new Blob([encryptedData], { type: 'application/octet-stream' });
                var downloadLink = document.createElement('a');
                var filename = (selectedFile ? selectedFile.name : 'encrypted-file') + '.gpg';
                
                if (window.URL && window.URL.createObjectURL) {
                    downloadLink.href = window.URL.createObjectURL(blob);
                    downloadLink.download = filename;
                    downloadLink.style.display = 'none';
                    document.body.appendChild(downloadLink);
                    downloadLink.click();
                    setTimeout(function() {
                        document.body.removeChild(downloadLink);
                        window.URL.revokeObjectURL(downloadLink.href);
                        
                        // 延迟一会儿再恢复原始图标，让用户看到下载动作
                        setTimeout(function() {
                            downloadResultBtn.innerHTML = originalHTML;
                        }, 800);
                    }, 300);
                } else {
                    alert('Your browser does not support direct downloads. Please try a more recent browser.');
                    // 恢复原始图标
                    downloadResultBtn.innerHTML = originalHTML;
                }
            } catch (e) {
                console.error('Download error:', e);
                alert('Error creating download: ' + e.message);
                // 错误时恢复原始图标
                downloadResultBtn.innerHTML = originalHTML;
            }
        }
        
        // 显示邮件发送确认对话框
        function showEmailConfirmDialog() {
            mdui.dialog({
                title: 'Confirm Send via email',
                content: `You will open a draft email with the encrypted content and the recipient's email address is <a class="mdui-typo" href="mailto:admin@stevezmt.top">admin@stevezmt.top</a>.<br/>
                Web GPG encryption cannot verify the sender if no signature, continue?`,
                buttons: [
                    {
                        text: 'Cancel'
                    },
                    {
                        text: 'Continue',
                        onClick: function() {
                            sendEncryptedEmail();
                        }
                    }
                ]
            });
        }
        
        // 发送加密内容到指定邮箱
        function sendEncryptedEmail() {
            const emailAddress = 'admin@stevezmt.top';
            const subject = 'Encrypted message via key.stevezmt.top';
            let body = '';
            let attachment = null;
            
            if (currentMode === 'text') {
                // 对于文本模式，直接在邮件正文中包含加密内容
                body = encodeURIComponent(result.textContent || '');
                
                // 尝试使用mailto协议
                window.location.href = `mailto:${emailAddress}?subject=${encodeURIComponent(subject)}&body=${body}`;
            } else {
                // 对于文件模式，需要先下载文件，然后提示用户手动附加
                try {
                    // 先下载文件
                    var blob = new Blob([encryptedData], { type: 'application/octet-stream' });
                    var filename = (selectedFile ? selectedFile.name : 'encrypted-file') + '.gpg';
                    
                    // 显示说明
                    mdui.snackbar({
                        message: 'You will need to attach the encrypted file to your email client.',
                        position: 'top',
                        timeout: 5000

                    });
                    
                    // 下载文件
                    var downloadLink = document.createElement('a');
                    if (window.URL && window.URL.createObjectURL) {
                        downloadLink.href = window.URL.createObjectURL(blob);
                        downloadLink.download = filename;
                        downloadLink.style.display = 'none';
                        document.body.appendChild(downloadLink);
                        downloadLink.click();
                        
                        setTimeout(function() {
                            document.body.removeChild(downloadLink);
                            window.URL.revokeObjectURL(downloadLink.href);
                            
                            // 下载后打开邮件客户端
                            setTimeout(function() {
                                window.location.href = `mailto:${emailAddress}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent('This draft is Empty!\nPlease add the encrypted file in email as attachment.\n请将下载的文件附加到邮件中。')}`;
                            }, 1000);
                        }, 100);
                    } else {
                        alert('Your browser does not support direct downloads. Please try a more recent browser.');
                    }
                } catch (e) {
                    console.error('sending mail err:', e);
                    alert('Error occured then creating mail:' + e.message);
                }
            }
        }
        
        // fuck ie
        function isIE() {
            var ua = window.navigator.userAgent;
            return ua.indexOf('MSIE ') > -1 || ua.indexOf('Trident/') > -1;
        }
        
        // 检测系统颜色主题变化
        if (window.matchMedia) {
            const colorSchemeQuery = window.matchMedia('(prefers-color-scheme: dark)');
            
            // 初始检测
            if (colorSchemeQuery.matches) {
                document.body.classList.add('dark-theme');
            } else {
                document.body.classList.remove('dark-theme');
            }
            
            // 监听变化
            colorSchemeQuery.addEventListener('change', (e) => {
                if (e.matches) {
                    document.body.classList.add('dark-theme');
                } else {
                    document.body.classList.remove('dark-theme');
                }
            });
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initialize);
        } else {
            initialize();
        }
        
        // 准备加密所需的密钥
        async function prepareKeysForEncryption() {
            // 处理自定义公钥
            if (useCustomPublicKey.checked) {
                if (!customPublicKeyText.value.trim()) {
                    customPublicKeyTextError.textContent = 'Please provide a valid public key to continue';
                    return false;
                }
                
                try {
                    customPublicKeyObj = await openpgp.readKey({ armoredKey: customPublicKeyText.value.trim() });
                    if (!customPublicKeyObj) {
                        customPublicKeyTextError.textContent = 'The provided public key format is invalid';
                        return false;
                    }
                } catch (err) {
                    customPublicKeyTextError.textContent = 'Public key parsing failed: ' + err.message;
                    return false;
                }
            }
            
            // 处理私钥（如果需要签名）
            if (signMessage.checked) {
                if (!privateKeyText.value.trim()) {
                    mdui.dialog({
                        title: 'Missing Private Key',
                        content: 'You chose to sign the message but no private key was provided. Would you like to continue with encryption only (no signing)?',
                        buttons: [
                            {
                                text: 'Cancel',
                                onClick: function() {
                                    // Nothing to do, dialog will close and return to the page
                                }
                            },
                            {
                                text: 'Encrypt Only',
                                onClick: function() {
                                    // Disable signing option
                                    signMessage.checked = false;
                                    signOptions.style.display = 'none';
                                    
                                    // Continue with encryption
                                    if (currentMode === 'text') {
                                        encryptTextHandler();
                                    } else {
                                        encryptFileHandler();
                                    }
                                }
                            }
                        ]
                    });
                    return false;
                }
                
                try {
                    // Read the private key
                    const privKey = await openpgp.readPrivateKey({ armoredKey: privateKeyText.value.trim() });
                    
                    // Check if the private key needs to be decrypted
                    if (privKey.isDecrypted()) {
                        privateKeyObj = privKey;
                    } else {
                        // Needs passphrase
                        const passphrase = privateKeyPassphrase.value;
                        if (!passphrase) {
                            privateKeyPassphraseError.textContent = 'Passphrase required';
                            
                            mdui.dialog({
                                title: 'Passphrase Required',
                                content: 'Your private key requires a passphrase. Please enter a passphrase or choose to encrypt only (no signing).',
                                buttons: [
                                    {
                                        text: 'Cancel',
                                        onClick: function() {
                                            // Nothing to do
                                        }
                                    },
                                    {
                                        text: 'Encrypt Only',
                                        onClick: function() {
                                            // Disable signing option
                                            signMessage.checked = false;
                                            signOptions.style.display = 'none';
                                            privateKeyPassphraseError.textContent = '';
                                            
                                            // Continue with encryption
                                            if (currentMode === 'text') {
                                                encryptTextHandler();
                                            } else {
                                                encryptFileHandler();
                                            }
                                        }
                                    }
                                ]
                            });
                            return false;
                        }
                        
                        try {
                            privateKeyObj = await openpgp.decryptKey({
                                privateKey: privKey,
                                passphrase: passphrase
                            });
                        } catch (decryptErr) {
                            privateKeyPassphraseError.textContent = 'Incorrect passphrase';
                            
                            mdui.dialog({
                                title: 'Private Key Decryption Failed',
                                content: 'Failed to decrypt private key: ' + decryptErr.message + '. Would you like to continue with encryption only (no signing)?',
                                buttons: [
                                    {
                                        text: 'Cancel',
                                        onClick: function() {
                                            // Nothing to do
                                        }
                                    },
                                    {
                                        text: 'Encrypt Only',
                                        onClick: function() {
                                            // Disable signing option
                                            signMessage.checked = false;
                                            signOptions.style.display = 'none';
                                            privateKeyPassphraseError.textContent = '';
                                            
                                            // Continue with encryption
                                            if (currentMode === 'text') {
                                                encryptTextHandler();
                                            } else {
                                                encryptFileHandler();
                                            }
                                        }
                                    }
                                ]
                            });
                            return false;
                        }
                    }
                } catch (err) {
                    privateKeyTextError.textContent = 'Invalid private key: ' + err.message;
                    
                    mdui.dialog({
                        title: 'Invalid Private Key',
                        content: 'Invalid private key format: ' + err.message + '. Would you like to continue with encryption only (no signing)?',
                        buttons: [
                            {
                                text: 'Cancel',
                                onClick: function() {
                                    // Nothing to do
                                }
                            },
                            {
                                text: 'Encrypt Only',
                                onClick: function() {
                                    // Disable signing option
                                    signMessage.checked = false;
                                    signOptions.style.display = 'none';
                                    privateKeyTextError.textContent = '';
                                    
                                    // Continue with encryption
                                    if (currentMode === 'text') {
                                        encryptTextHandler();
                                    } else {
                                        encryptFileHandler();
                                    }
                                }
                            }
                        ]
                    });
                    return false;
                }
            }
            
            return true;
        }
        
        // 更新按钮状态（用于替代snackbar）
        function updateButtonStatus(button, icon, text, success, message) {
            const originalClasses = button.className;
            const originalIconHTML = icon.innerHTML;
            const originalText = text.textContent;
            
            if (success) {
                // 成功状态
                icon.innerHTML = '&#xe5ca;';
                button.className = originalClasses.replace('mdui-color-theme-accent', 'mdui-color-green');
            } else {
                // 失败状态
                icon.innerHTML = '&#xe000;';
                button.className = originalClasses.replace('mdui-color-theme-accent', 'mdui-color-red');
            }
            
            text.textContent = message;
            
            // 3秒后恢复
            setTimeout(function() {
                icon.innerHTML = originalIconHTML;
                button.className = originalClasses;
                text.textContent = originalText;
            }, 3000);
        }
        
        // 重置公钥相关的反馈信息
        function resetPublicKeyFeedback() {
            customPublicKeyTextError.textContent = '';
            customPublicKeyTextHelper.textContent = '';
            publicKeyFileInfo.textContent = '';
            publicKeyFileError.textContent = '';
        }
        
        // 重置私钥相关的反馈信息
        function resetPrivateKeyFeedback() {
            privateKeyTextError.textContent = '';
            privateKeyTextHelper.textContent = '';
            privateKeyFileInfo.textContent = '';
            privateKeyFileError.textContent = '';
            privateKeyPassphraseError.textContent = '';
        }
        
    })();
    </script>
</body>
</html>
